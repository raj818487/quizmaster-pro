<div class="user-dashboard">
  <!-- 2x2 Category Cards Grid -->
  <div class="category-grid">
    <!-- Top Row -->
    <div
      class="category-card"
      [class.active]="activeCategory === 'all'"
      (click)="setActiveCategory('all')"
    >
      <div class="card-icon">ï¿½</div>
      <div class="card-content">
        <h3>All Quizzes</h3>
        <p>Browse all available quizzes</p>
        <span class="quiz-count">{{ getAllCount() }} total</span>
      </div>
    </div>

    <div
      class="category-card"
      [class.active]="activeCategory === 'public'"
      (click)="setActiveCategory('public')"
    >
      <div class="card-icon">ğŸŒ</div>
      <div class="card-content">
        <h3>Public Quizzes</h3>
        <p>Open quizzes for everyone</p>
        <span class="quiz-count">{{ getPublicCount() }} quizzes</span>
      </div>
    </div>

    <!-- Bottom Row -->
    <div
      class="category-card"
      [class.active]="activeCategory === 'private'"
      (click)="setActiveCategory('private')"
    >
      <div class="card-icon">ğŸ”’</div>
      <div class="card-content">
        <h3>Private Quizzes</h3>
        <p>Exclusive access quizzes</p>
        <span class="quiz-count">{{ getPrivateCount() }} quizzes</span>
      </div>
    </div>

    <div
      class="category-card"
      [class.active]="activeCategory === 'assigned'"
      (click)="setActiveCategory('assigned')"
    >
      <div class="card-icon">ï¿½</div>
      <div class="card-content">
        <h3>My Assigned</h3>
        <p>Quizzes assigned to you</p>
        <span class="quiz-count">{{ getAssignedCount() }} quizzes</span>
      </div>
    </div>
  </div>

  <!-- Current Category Header -->
  <div class="current-category-header">
    <h2>
      <span class="category-icon">{{ getCategoryIcon() }}</span>
      {{ getCategoryTitle() }}
    </h2>
    <button class="refresh-button" (click)="refreshQuizzes()">
      <span class="refresh-icon">ğŸ”„</span>
      Refresh
    </button>
  </div>

  <div class="quizzes-grid">
    <div *ngFor="let quiz of filteredQuizzes" class="quiz-card">
      <div class="quiz-header">
        <h3>{{ quiz.title }}</h3>
        <div class="quiz-badges">
          <span
            class="badge"
            [class.public]="quiz.is_public"
            [class.private]="!quiz.is_public"
          >
            {{ quiz.is_public ? 'Public' : 'Private' }}
          </span>
          <span
            class="badge assignment-badge"
            [class.assigned]="quiz.assignment_status === 'assigned'"
            [class.not-assigned]="quiz.assignment_status === 'not_assigned'"
          >
            {{ quiz.assignment_status === 'assigned' ? 'Assigned' : 'Not
            Assigned' }}
          </span>
          <span
            class="badge access-badge"
            [class.has-access]="quiz.access_status === 'has_access'"
            [class.no-access]="quiz.access_status === 'no_access'"
            [class.pending]="quiz.access_status === 'pending_request'"
          >
            {{ quiz.access_status === 'has_access' ? 'Access Granted' :
            quiz.access_status === 'pending_request' ? 'Access Pending' : 'No
            Access' }}
          </span>
          <span
            class="time-badge"
            *ngIf="quiz.time_limit && quiz.time_limit > 0"
          >
            {{ quiz.time_limit }} min
          </span>
        </div>
      </div>

      <div class="quiz-description">
        <p>{{ quiz.description || 'No description available' }}</p>
      </div>

      <div class="quiz-status" *ngIf="quiz.display_message">
        <div class="status-message" [class.warning]="!quiz.can_start">
          <i class="icon">âš ï¸</i>
          {{ quiz.display_message }}
        </div>
      </div>

      <div class="quiz-meta">
        <div class="quiz-stats">
          <span class="stat">
            <i class="icon">ğŸ“</i>
            Questions available
          </span>
          <span class="stat" *ngIf="quiz.user_permission">
            <i class="icon">ğŸ‘¤</i>
            {{ quiz.user_permission }}
          </span>
        </div>
      </div>

      <div class="quiz-actions">
        <button
          class="btn"
          [class.btn-primary]="quiz.can_start"
          [class.btn-secondary]="!quiz.can_start && quiz.access_status !== 'no_access'"
          [class.btn-request]="!quiz.can_start && quiz.access_status === 'no_access' && quiz.assignment_status === 'not_assigned'"
          [class.btn-pending]="quiz.access_status === 'pending_request' || isRequestingAccess(quiz.id!)"
          [disabled]="isRequestButtonDisabled(quiz)"
          (click)="startQuiz(quiz)"
        >
          <span
            *ngIf="isRequestingAccess(quiz.id!) && quiz.access_status === 'no_access'"
            class="spinner-inline"
          ></span>
          {{ quiz.can_start ? 'Start Quiz' : getRequestButtonText(quiz) }}
        </button>
        <button class="btn btn-secondary" (click)="viewQuizDetails(quiz)">
          View Details
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="filteredQuizzes.length === 0" class="no-quizzes">
    <div class="empty-state">
      <div class="empty-icon">ğŸ“š</div>
      <h3>No quizzes available</h3>
      <p>{{ getEmptyMessage() }}</p>
    </div>
  </div>

  <!-- Loading state -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Loading quizzes...</p>
  </div>

  <!-- Error message -->
  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
    <button class="btn btn-primary" (click)="loadQuizzes()">Retry</button>
  </div>
</div>
